<button class="btn btn-primary" (click)="openToolsModal()">Select tool</button>

<ng-template #toolsModalTemplate>
  <div class="modal-header">
    <div class="col-md-11">
      <ch-tool-title [toolSelection]="toolSelection">
      </ch-tool-title>
    </div>
    <div class="col-md-1" style="padding-right: 0">
      <button type="button" class="close pull-right" (click)="close(false)"><i class="fa fa-times"></i></button>
    </div>
  </div>

  <div class="modal-body">
    <button class="btn btn-success pull-right" (click)="runJob()" [disabled]="!isRunEnabled()">
      <span class="glyphicon glyphicon-play"></span> Run
    </button>

    <ngb-tabset>
      <ngb-tab>
        <ng-template ngbTabTitle>Tools</ng-template>
        <ng-template ngbTabContent>
          <!-- module buttons -->
          <div class="row">
            <div class="col">
              <div class="btn-group">
                <button type="button" class="btn btn-primary"
                        (click)="selectModule(module)"
                        *ngFor="let module of modules | modulepipe:searchTool"
                        [ngClass]="{'btn-primary':module === selectedModule,
                'btn-secondary':module !== selectedModule}">{{module.name}}
                </button>
              </div>

            </div>
            <div class="col">
              <div class="search-div pull-right">
                <input class="form-control" type="text" [(ngModel)]="searchTool"
                       [placeholder]="'Search tool'" (keyup)="toolSearchKeyEvent($event)">
              </div>
            </div>
          </div>

          <!--&lt;!&ndash; category and tool lists &ndash;&gt;-->
          <div class="row">
            <div class="col"><h5>Category</h5></div>
            <div class="col"><h5>Tool</h5></div>
          </div>

          <div class="row">

            <div class="col-6">
              <div class="btn-group-vertical tool-list">
                <button type="button" class="btn btn-secondary tool-list-item"
                        [ngClass]="{'active':category===selectedCategory}"
                        (click)="selectCategory(category)"
                        *ngFor="let category of selectedModule.categories | categorypipe: searchTool">
                  <ch-tool-list-item [color]="category.color" [categoryname]="category.name"></ch-tool-list-item>
                </button>
              </div>
            </div>

            <div class="col-6">
              <div class="btn-group-vertical tool-list" *ngIf="selectedCategory">
                <button type="button"
                        class="btn btn-secondary tool-list-item"
                        [ngClass]="{'active':tool===toolSelection}"
                        (click)="selectTool(tool)"
                        *ngFor="let tool of selectedCategory.tools | toolpipe:searchTool"
                        id="tool-button-{{tool.id}}"
                        ngbPopover="{{tool.description}}"
                        triggers="mouseenter:mouseleave"
                        container="body"
                        placement="right">
                  {{tool.name.displayName}}
                </button>
              </div>
            </div>
          </div>


        </ng-template>
      </ngb-tab>

      <!-- parameters -->
      <ngb-tab [disabled]="!toolSelection">
        <ng-template ngbTabTitle>Parameters</ng-template>
        <ng-template ngbTabContent>
          <ch-tools-parameter-form [tool]="toolSelection.tool"></ch-tools-parameter-form>
        </ng-template>
      </ngb-tab>

      <ngb-tab [disabled]="!toolSelection">
        <ng-template ngbTabTitle>Inputs</ng-template>
        <ng-template ngbTabContent>
  			<ch-tool-inputs
          [sessionData]="sessionData"
          [inputBindings]="toolSelection.inputBindings"
          [tool]="toolSelection.tool"
          [selectedDatasets]="selectedDatasets"
          (updateBindings)="updateBindings($event)"></ch-tool-inputs>
        </ng-template>
      </ngb-tab>

      <ngb-tab [disabled]="!toolSelection">
        <ng-template ngbTabTitle>Manual</ng-template>
        <ng-template ngbTabContent>
          <p>TBD</p>
        </ng-template>
      </ngb-tab>

      <ngb-tab [disabled]="!toolSelection">
        <ng-template ngbTabTitle>Source Code</ng-template>
        <ng-template ngbTabContent>
          <ch-tool-source [selectedTool]="toolSelection.tool"></ch-tool-source>
        </ng-template>
      </ngb-tab>


    </ngb-tabset>

  </div>    <!--end of modal body-->
</ng-template>
