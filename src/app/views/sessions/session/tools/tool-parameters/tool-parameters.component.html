<div *ngIf="ready" class="container">

  <div class="text-center">
    <!-- warning title -->
    <span class="text-warning" [class.invisible]="!showWarning">
      <i class="fas fa-fw fa-exclamation-circle"></i>
      <span class="font-italic">{{warningText}}</span>
    </span>

    <!-- close button -->
    <button class="btn btn-xs float-right p-0" (click)="closeDropDownDialog()">
      <i class="fas fa-times"></i>
    </button>
  </div>

  <!-- parameters -->
  <h2 class="h2-xs mt-1 mb-2">Parameters</h2>

  <form name="paramForm" *ngIf="tool">
    <div *ngIf="tool.parameters.length === 0" class="font-italic text-smaller">
      No parameters
    </div>

    <table class="table table-sm" *ngIf="tool.parameters.length > 0">
      <tbody>
        <tr *ngFor="let parameter of tool.parameters; let i = index">

          <td style="width: 60%">
            <!-- parameter name -->
            {{ getDisplayName(parameter) }}
            <span class="text-sm text-muted" *ngIf="parameter.optional">
              <i>(optional)</i>
            </span>

            <!-- parameter description -->
            <div class="text-sm text-muted">{{parameter.description}}</div>
          </td>

          <!-- parameter value -->
          <td>
            <!-- selection parameter -->
            <select *ngIf="toolService.isSelectionParameter(parameter)" class="w-100" name="parameter_{{i}}"
              [(ngModel)]="parameter.value" (ngModelChange)="validate()">
              <option *ngFor="let option of parameter.selectionOptions" value="{{option.id}}">
                {{ option.displayName || option.id }}
              </option>
            </select>

            <!-- number -->
            <input *ngIf="toolService.isNumberParameter(parameter)" class="w-100" type="number" [(ngModel)]="parameter.value"
              name="parameter_{{i}}" min="{{parameter.from}}" max="{{parameter.to}}" step="{{toolService.getStepSize(parameter)}}"
              required="{{!parameter.optional}}" (ngModelChange)="validate()" />

            <!-- string -->
            <input *ngIf="toolService.isStringParameter(parameter)" type="text" class="w-100" name="parameter_{{i}}"
              [(ngModel)]="parameter.value" required="{{!parameter.optional}}" (ngModelChange)="validate()" />

            <!-- validation message -->
            <!-- FIXME both ? temp fix -->
            <div *ngIf="!validationResults.get(parameter.name.id)?.valid" class="text-sm text-warning">{{validationResults.get(parameter.name.id)?.message}}</div>
          </td>

          <!-- buttons -->
          <td>
            <!-- reset to default -->
            <button type="button" class="btn btn-sm btn-outline-dark btn-no-border float-right" [class.invisible]="!resetVisible(parameter)"
              (click)="reset(parameter, $event)" title="Reset to default">
              <i class="fas fa-undo"></i>
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </form>
</div>