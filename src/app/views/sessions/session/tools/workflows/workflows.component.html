<!-- Workflow tab -->
<div class="row">
  <div class="col col-left">
    <h4 class="h4-xs lighter">Saved workflows</h4>
  </div>
  <div class="col col-middle">
    <h4 class="h4-xs lighter">Running workflows</h4>
  </div>
  <div class="col col-right"></div>
</div>
<div class="row">
  <!-- saved workflows list -->
  <div class="col col-left">
    <button
      class="btn btn-sm btn-outline-secondary"
      (click)="saveWorkflow()"
      title="Save workflow"
      [disabled]="selectedDatasets.length === 0"
    >
      Save from selected files
    </button>
    &nbsp;
    <button
      class="btn btn-sm btn-success"
      (click)="runWorkflowPlan()"
      title="Run workflow"
      [disabled]="selectedDatasets.length === 0 || selectedWorkflowPlan == null"
    >
      Run
    </button>
    <br />
    <br />
    <div class="list-group-sm">
      <button
        type="button"
        class="list-group-item list-group-item-action tool-list-item"
        [ngClass]="{
          active: plan === selectedWorkflowPlan,
          compact: settingsService.compactToolList$.getValue()
        }"
        (click)="selectWorkflowPlan(plan)"
        *ngFor="let plan of workflowPlans"
      >
        <ch-tool-list-item [categoryname]="plan.name"> </ch-tool-list-item>
        <span class="" (click)="deleteWorkflowPlan(plan)">
          &times;
        </span>
      </button>
    </div>
  </div>
  <div class="col col-middle">
    <div class="list-group-sm">
      <button
        type="button"
        class="list-group-item list-group-item-action tool-list-item"
        [ngClass]="{
          active: run === selectedWorkflowRun,
          compact: settingsService.compactToolList$.getValue()
        }"
        (click)="selectWorkflowRun(run)"
        *ngFor="let run of workflowRuns"
      >
        <ch-tool-list-item
          [categoryname]="run.name + ' ' + run.state"
        ></ch-tool-list-item>
        <span class="" (click)="deleteWorkflowRun(run)">
          &times;
        </span>
      </button>
    </div>
  </div>
  <div class="col col-right">
    <!-- workflow plan details -->
    <div *ngIf="selectedWorkflowPlan != null">
      <h3 class="panel-title">{{ selectedWorkflowPlan.name }}</h3>
      <div class="border p-3" style="background-color: white;">
        <table class="table table-sm text-sm">
          <tr>
            <td class="lighter">Created:</td>
            <td width="100%">
              {{ selectedWorkflowPlan.created | localDate }}
            </td>
          </tr>
          <tr>
            <td class="lighter">Original duration:</td>
            <td width="100%">
              {{ selectedWorkflowPlan.originalDuration }}
            </td>
          </tr>
          <tr>
            <td class="lighter">Original duration:</td>
            <td width="100%">
              {{ selectedWorkflowPlan.originalDuration }}
            </td>
          </tr>
          <tr>
            <td class="lighter">Tools:</td>
          </tr>
          <tr *ngFor="let job of selectedWorkflowPlan.workflowJobPlans">
            <td class="lighter"></td>
            <td class="lighter">{{ job.toolName }}</td>
            <td width="100%"></td>
          </tr>
          <!-- <tr>
          <td class="lighter">Notes:</td>
          <td width="100%">
            <p class="mb-1" *ngFor="let line of session.notes?.split( '\n') ">
              {{line}}
            </p>
          </td>
        </tr> -->
        </table>
      </div>
    </div>
    <!-- workflow run details -->
    <div *ngIf="selectedWorkflowRun != null">
      <h3 class="panel-title">
        {{ selectedWorkflowRun.name }} {{ selectedWorkflowRun.state }}
      </h3>
      <div class="border p-3" style="background-color: white;">
        <table class="table table-sm text-sm">
          <tr>
            <td class="lighter">Start time:</td>
            <td width="100%">
              {{ selectedWorkflowRun.created | localDate }}
            </td>
          </tr>
          <tr>
            <td class="lighter">End time:</td>
            <td width="100%">
              {{ selectedWorkflowRun.endTime | localDate }}
            </td>
          </tr>
          <tr>
            <td class="lighter">Username:</td>
            <td width="100%">
              {{ selectedWorkflowRun.createdBy }}
            </td>
          </tr>
          <tr *ngFor="let job of selectedWorkflowRunJobs">
            <td class="lighter">{{ job.toolName }}</td>
            <td width="100%">{{ job.state }}</td>
          </tr>
        </table>
      </div>
    </div>
  </div>
</div>
