<div class="modal-header">
  <h4 class="modal-title">History of {{dataset.name}}</h4>
  <button type="button" class="close" aria-label="Close" (click)="activeModal.close()">
    <span aria-hidden="true">&times;</span>
  </button>
</div>
<div class="modal-body">

  <!-- options -->
  <h2 class="h2-xs">Fields</h2>
  <div class="form-group">
    <div class="row">
      <div *ngFor="let option of historyOptions;let i=index" class="col-sm">
        <label class="no-break">
          <input type="checkbox" name="{{option.id}}" value="{{option.enabled}}" [checked]="option.enabled"
            (change)="updateOption(option)" /> {{option.name}}
        </label>
      </div>
    </div>
  </div>

  <!-- history steps -->
  <h2 class="h2-xs">History</h2>
  <table class="table table-sm text-sm table-condensed">

    <div class="step" *ngFor="let item of datasetHistorySteps;let i=index">

      <tr *ngIf="historyOptionsMap.get('stepTitle').enabled">
        <td class="" colspan="2">
          <h4 class="h4-xs step-header">Step {{i+1}}</h4>
        </td>
      </tr>

      <tr *ngIf="historyOptionsMap.get('sourceJobName').enabled">
        <td class="lighter no-break">{{historyOptionsMap.get('sourceJobName').name}}:</td>
        <td class="width-max">{{item.sourceJob.toolCategory}} / {{item.sourceJob.toolName}}</td>
      </tr>

      <tr *ngIf="historyOptionsMap.get('inputFileNames').enabled">
        <td class="lighter no-break">{{historyOptionsMap.get('inputFileNames').name}}:</td>
        <td class="width-max">{{item.inputFileNamesString}} </td>
      </tr>

      <tr *ngIf="historyOptionsMap.get('parameters').enabled">
        <td class="lighter no-break">{{historyOptionsMap.get('parameters').name}}:</td>
        <td class="width-max" id="parameters-container">
          <ch-dataset-parameter-list *ngIf="item.sourceJob && item.sourceJob.parameters.length > 0"
            [parameters]="item.sourceJob.parameters" [parametersLimit]="-1" [tool]="null" [historyMode]="true">
          </ch-dataset-parameter-list>
        </td>
      </tr>

      <tr *ngIf="historyOptionsMap.get('date').enabled">
        <td class="lighter no-break">{{historyOptionsMap.get('date').name}}:</td>
        <td class="width-max">{{item.creationDate| localDate}}</td>
      </tr>

      <tr *ngIf="historyOptionsMap.get('resultFileName').enabled">
        <td class="lighter">{{historyOptionsMap.get('resultFileName').name}}:</td>
        <td class="width-max">{{item.datasetName}} </td>
      </tr>

      <tr *ngIf="historyOptionsMap.get('sourceCode').enabled">
        <td class="lighter no-break">Source code:</td>
        <td class="width-max">
          <pre *ngIf="item.sourceCode != null && item.sourceCode.length > 0"
            style="overflow: auto; width: 600px"><code>{{item.sourceCode}}</code></pre>
        </td>
      </tr>


    </div>
  </table>
</div>

<div class="modal-footer">
  <button type="button" class="btn btn-secondary" (click)="activeModal.close()">Close</button>
</div>
