<div *ngIf="job">

  <div class="row">
    <div class="col-md-11">
      <h3 class="h3-xs"><span class="lighter">Job:</span> {{job.toolCategory + " / " + job.toolName}}</h3>
    </div>

    <div class="col-md-1">
      <button class="btn btn-sm btn-link pull-right" (click)="close()">Close</button>
    </div>
  </div>
  <div class="chipster-highlight">

    <div>Status: {{state}} <span *ngIf="isRunning && job.stateDetail">({{job.stateDetail}})</span>
      <button *ngIf="isRunning" class="btn btn-sm btn-link" (click)="cancelJob()">Cancel</button></div>

    <div class="row">
      <div class="col-md-12">
        <table class="table table-sm text-sm">
          <tr>
            <td class="lighter">Created:</td>
            <td width="100%">{{job.created | localDate}}</td>
          </tr>
          <tr>
            <td class="lighter">Started:</td>
            <td width="100%">{{job.startTime | localDate}}</td>
          </tr>
          <tr>
            <td class="lighter">Ended:</td>
            <td>{{job.endTime | localDate}}</td>
          </tr>
          <tr>
            <td class="lighter">Duration:</td>
            <td></td>
          </tr>
          <tr *ngIf="failed">
            <td class="lighter" style="white-space: nowrap">Error message:</td>
            <td><span *ngIf="job.stateDetail">{{job.stateDetail}}</span></td>
          </tr>
        </table>
      </div>
    </div>

    <div class="row">
      <div class="col-md-12">
        <div>Parameters</div>
        <div>
          <table class="table table-sm text-sm">
            <tr *ngFor="let param of job.parameters">
              <td style="white-space: nowrap">{{param.displayName}}</td>
              <td width="100%">{{param.value}}</td>
            </tr>
          </table>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-md-12">
        <div>Inputs</div>
        <div>
          <table class="table table-sm text-sm">
            <tr *ngFor="let input of job.inputs">
              <td style="white-space: nowrap">{{input.inputId}}</td>
              <td width="100%">{{input.datasetId}}</td>
            </tr>
          </table>
        </div>
      </div>
    </div>
  </div>


  <ngb-tabset>
    <ngb-tab id="screenOutput">
      <ng-template ngbTabTitle><i *ngIf="isRunning" class="fa fa-circle-o-notch fa-spin fa-fw"></i>Screen output</ng-template>
      <ng-template ngbTabContent>
        <div class="visualization-panel">
          <pre style="margin-bottom: 0em">{{screenOutput}}</pre>
          <i *ngIf="isRunning" class="fa fa-circle-o-notch fa-spin fa-fw"></i>
        </div>
      </ng-template>
    </ngb-tab>

    <ngb-tab id="sourceCode">
      <ng-template ngbTabTitle><span class="glyphicon glyphicon-font"></span> Source code</ng-template>
      <ng-template ngbTabContent>
        <div class="visualization-panel">
          <pre>{{job.sourceCode}}</pre>
        </div>
      </ng-template>
    </ngb-tab>
  </ngb-tabset>

</div>
