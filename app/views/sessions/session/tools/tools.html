<div ng-controller="ToolCtrl">

    <div class="bar pull-right search-div">
        <input type="text" class="search" ng-model="searchTool" ng-change="selectFirstVisible()"
               placeholder="search tool" ng-keyup="toolSearchKeyEvent($event)"/>
        <button class="clear-search-button no-border" ng-show="searchTool"
                ng-click="searchTool = null">
            <span class="glyphicon glyphicon-remove"></span>
        </button>
    </div>

    <!-- Tools div -->
    <div class="row">
        <ul class="nav nav-pills btn-xs">
            <li ng-class="{active:module === selectedModule}" ng-repeat="module in data.modules | moduleFilter:searchTool">
                <a href ng-click="selectModule(module)">{{module.name}}</a>
            </li>
        </ul>
    </div>

    <!-- Tab Content -->
    <div>
        <div class="row">
            <div class="col-xs-4 no-padding">
                <div id="category-table" class="tool-height">
                    <div id="category-list" class="list-group" data-toggle="buttons">
                        <button type="button" class="list-group-item thin-list-group-item"
                                ng-class="{'active':category===selectedCategory}"
                                ng-click="selectCategory(category)"
                                ng-repeat="category in categories | categoryFilter:searchTool">
                            <span><tool-circle toolcolor="category.color"></span>
                            {{category.name}}
                        </button>
                    </div>
                </div>
            </div>
            <!-- end of tool category table with column width 4 -->
            <div class="col-xs-4">
                <div id="tool-table" class="tool-height">
                    <div id="tool-list" class="list-group" data-toggle="buttons">
                        <button type="button" class="list-group-item thin-list-group-item"
                                ng-class="{'active':tool.id===selectedTool.name.id}"
                                ng-click="selectTool(tool.id)"
                                ng-repeat="tool in selectedCategory.tools|toolFilter:searchTool"
                                id="tool-button-{{tool.id}}">
                            {{tool.name}}
                        </button>
                    </div>
                </div>
            </div>
            <div class="col-xs-4 tool-height no-padding" id="tool-details-panel">

                <div class="btn-group btn-group-justified"  role="group">
                    <button class="btn btn-default" style="width: 50%"
                        ng-disabled="!isParametersEnabled()"
                        data-toggle="modal" data-target="#parameterModal">
                        Parameters
                    </button>
                    <button class="btn btn-success" style="width: 50%"
                        ng-click="runJob()" ng-disabled="!isRunEnabled()">
                        <span class="glyphicon glyphicon-play">
                        </span>
                        Run
                    </button>
                </div>

                <!-- Tool Description div -->
                <div class="tool-description" ng-show="selectedTool">
                    <p>{{selectedTool.description}}</p>
                    <!--Tool source-->
                    <p>
                        <a href ng-click="getSource()" data-toggle="modal" data-target="#toolSourceModal" ng-disabled="!selectedTool">
                            Source code
                        </a>
                    </p>
                </div>

                <!--Parameter-->
            </div>
        </div>
    </div>
    <!--end of tabset div-->

    <div id="parameterModal" class="modal fade" role="dialog">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times</button>
                    <h4 class="modal-title">{{selectedTool.name.displayName}}</h4>
                </div>
                <!--end of modal header-->
                <div class="modal-body"
                    ng-include="'app/partials/parametermodal.html'"></div>
                <!--end of modal body-->
            </div>
            <!--end of modal-content-->

        </div>
        <!--end of modal-dialog-->

    </div>

    <div id="toolSourceModal" class="modal fade" role="dialog">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times</button>
                    <h4 class="modal-title">{{selectedTool.name.displayName}}</h4>
                </div>
                <!--end of modal header-->
                <div class="modal-body">
                    <pre>{{source}}</pre>
                </div>
                <!--end of modal body-->
            </div>
            <!--end of modal-content-->

        </div>
        <!--end of modal-dialog-->
    </div>

    <div id="toolErrorModal" class="modal fade" role="dialog">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times</button>
                    <h4 class="modal-title">{{toolErrorTitle}}</h4>
                </div>
                <!--end of modal header-->
                <div class="modal-body">
                    <h5>Error details</h5>
                    <pre>{{toolError.stateDetail}}</pre>
                    <h5>Screen output</h5>
                    <pre>{{toolError.screenOutput}}</pre>
                </div>
                <!--end of modal body-->
            </div>
            <!--end of modal-content-->
        </div>
        <!--end of modal-dialog-->
    </div>
</div>

